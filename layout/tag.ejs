<main class="content" style="margin-top: 40px;">

    <%- partial('_widget/tag-cloud') %>

    <div class="container">
        <%
        const hashCode = function (str) {
            if (!str && str.length === 0) {
                return 0;
            }

            let hash = 0;
            for (let i = 0, len = str.length; i < len; i++) {
                hash = ((hash << 5) - hash) + str.charCodeAt(i);
                hash |= 0;
            }
            return hash;
        };
        %>

        <article>
            <div class="row tags-posts">
                <% page.posts.sort('date').reverse().forEach(post => { %>
                <%
                    let tagArr = [];
                    if (post.tags && post.tags.length > 0) {
                        post.tags.forEach(tag => {
                            tagArr.push(tag.name);
                        });
                    }
                    let tags = tagArr.join(', ');
                %>
                <div class="article tag-post col s12 m6 l4" data-tags="<%- tags %>" data-aos="fade-up">
                    <div class="card">
                        <a href="<%- url_for(post.path) %>">
                            <div class="card-image tag-image">
                                <% if (post.img) { %>
                                <img src="<%= post.img %>" class="responsive-img" alt="<%- post.title %>">
                                <% } else { %>
                                <%
                                    const len = theme.featureImages.length;
                                    const num = Math.abs(hashCode(post.title) % len);
                                    const featureimg = theme.featureImages[num];
                                %>
                                <img src="<%= featureimg %>" class="responsive-img" alt="<%- post.title %>">
                                <% } %>
                                <span class="card-title tag-post-title"><%- post.title %></span>
                            </div>
                        </a>
                        <div class="card-content article-content">
                            <!--<div class="summary"><%- strip_html(post.content).substring(0, 80) %>...</div>-->
                            <div class="publish-info">
                                <span class="publish-date">
                                    <i class="fa fa-clock-o fa-fw icon-date"></i><%= date(post.date, config.date_format) %>
                                </span>
                                <span class="publish-author">
                                    <% if (post.categories && post.categories.length > 0) { %>
                                    <i class="fa fa-bookmark fa-fw icon-category"></i>
                                    <% post.categories.forEach(category => { %>
                                    <a href="<%- url_for(category.path) %>" class="post-category" target="_blank">
                                    <%- category.name %>
                                    </a>
                                    <% }); %>
                                    <% } else if (post.author && post.author.length > 0) { %>
                                    <i class="fa fa-user fa-fw"></i>
                                    <%- post.author %>
                                    <% } else { %>
                                    <i class="fa fa-user fa-fw"></i>
                                    <%- config.author %>
                                    <% } %>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                <% }); %>
            </div>
        </article>
    </div>
</main>

<% if (page.total > 1) { %>
<%- partial('_partial/paging') %>
<% } %>
